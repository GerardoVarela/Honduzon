<app-navbar></app-navbar>

<section>
  <div
    class="card"
    style="
      padding: 25px;
      margin-top: 25px;
      border-radius: 20px;
      max-height: none;
    "
  >
    <div
      class="card-body"
      style="
        border-style: groove;
        border-radius: 20px;
        padding-top: 0;
        padding-bottom: 0px;
      "
    >
      <!-- <div class="container" style="padding: 0px"> -->
      <div class="row" style="border-bottom: 1px dashed #47525e">
        <div class="col-md-3" style="width: 15%; text-align: center">
          <svg
            class="bi bi-chat-square-text"
            xmlns="http://www.w3.org/2000/svg"
            width="1em"
            height="1em"
            fill="currentColor"
            viewBox="0 0 16 16"
            style="font-size: 45px; color: #00bce4; margin-top: 10px"
          >
            <path
              d="M14 1a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1h-2.5a2 2 0 0 0-1.6.8L8 14.333 6.1 11.8a2 2 0 0 0-1.6-.8H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h2.5a1 1 0 0 1 .8.4l1.9 2.533a1 1 0 0 0 1.6 0l1.9-2.533a1 1 0 0 1 .8-.4H14a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"
            ></path>
            <path
              d="M3 3.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zM3 6a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9A.5.5 0 0 1 3 6zm0 2.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5z"
            ></path>
          </svg>
        </div>
        <div
          class="col-md-3"
          style="width: 20%; text-align: left; border-right: 1px dashed #47525e"
        >
          <strong style="font-size: 40px; color: #47525e">Chat</strong>
        </div>
        <div class="col-md-3" style="width: 15%; text-align: center">
          <svg
            class="bi bi-emoji-smile"
            xmlns="http://www.w3.org/2000/svg"
            width="1em"
            height="1em"
            fill="currentColor"
            viewBox="0 0 16 16"
            style="font-size: 45px; margin-top: 8px; color: #47525e"
          >
            <path
              d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"
            ></path>
            <path
              d="M4.285 9.567a.5.5 0 0 1 .683.183A3.498 3.498 0 0 0 8 11.5a3.498 3.498 0 0 0 3.032-1.75.5.5 0 1 1 .866.5A4.498 4.498 0 0 1 8 12.5a4.498 4.498 0 0 1-3.898-2.25.5.5 0 0 1 .183-.683zM7 6.5C7 7.328 6.552 8 6 8s-1-.672-1-1.5S5.448 5 6 5s1 .672 1 1.5zm4 0c0 .828-.448 1.5-1 1.5s-1-.672-1-1.5S9.448 5 10 5s1 .672 1 1.5z"
            ></path>
          </svg>
        </div>
        <div
          class="col-md-3"
          style="width: 50%; text-align: left; padding-top: 13px"
        >
          <strong style="font-size: 22px; color: #47525e"
            >User name (seller)</strong
          >
        </div>
      </div>
      <!-- </div> -->
      <!-- <div class="container" style="padding: 0px"> -->
      <div class="row" style="max-height: 600px">
        <div
          class="col-md-6"
          style="
            width: 35%;
            height: 600px;
            max-height: 600px;
            border-right: 1px dashed #47525e;
            overflow-y: scroll;
          "
        >
          <section>
            <div *ngFor="let chat of allUserChats">
              <a role="button" (click)="selectChat(chat.ID_CHAT, chat.ID_USUSARIO2)">
                <div [ngClass]="{'selected': chat.ID_CHAT === chatSelected}" class="row" style="max-height: 150px; height: 150px">
                  <div
                    class="col"
                    style="max-height: none; padding-top: 13px; text-align: center"
                  >
                    <img
                      src="../../../../assets/12.webp"
                      style="width: 170px; border-radius: 20px; height: 125px"
                    />
                  </div>
                  <div class="col" style="text-align: left; padding-top: 20px">
                    <div style="color: #47525e">
                      <small style="font-size: 20px">@User Name</small>
                    </div>
                    <div style="margin-top: 5px">
                      <ng-container *ngIf="idCurrentUser == chat.id_USUARIO1; else notCurrent">
                        <strong style="font-size: 26px">{{chat.user2}}</strong>
                      </ng-container>
                      <ng-template #notCurrent>
                        <strong style="font-size: 26px">{{chat.user1}}</strong>
                      </ng-template>
                      
                    </div>
                  </div>
                </div>
              </a>
            </div>
          </section>
        </div>
        <div
          class="col-md-6"
          style="height:600px; max-height:600px; width: 65%; padding-top: 10px;"
        >
          <div class="col" id="scrollChat" style="height: 510px; max-height: 510px; padding-bottom: 5px; overflow-y: scroll">
            <div class="row" style="width: 100%" *ngFor="let message of chatService.chats">
              <ng-container *ngIf="message.messageType == 1; else elseNotCurrentUser">
                <div style="text-align: -webkit-right">
                  <p
                    class="personalMessage"
                  >
                    {{message.message}}
                  </p>
                </div>
              </ng-container>
              <ng-template #elseNotCurrentUser>
                <div>
                  <p
                    class="receivedMessage"
                  >
                    {{message.message}}
                  </p>
                </div>
              </ng-template>
            </div>
          </div>
          <div class="row" style="height: 90px; padding-bottom: 10px">
            <div
              class="col"
              style="padding: 0px; background: #eceff1; text-align: center"
            >
              <form (ngSubmit)="enviarMensaje()">
                <input
                  [(ngModel)]="nuevoMensaje"
                  [ngModelOptions]="{ standalone: true }"
                  class="form-control-lg"
                  type="text"
                  style="
                    width: 700px;
                    border-radius: 20px;
                    height: 45px;
                    margin-top: 20px;
                  "
                  placeholder="Escribe un mensaje ..."
                />
              </form>
            </div>
            <div
              class="col"
              style="
                background: #eceff1;
                border-bottom-right-radius: 20px;
                max-width: 15%;
                padding: 0px;
                text-align: left;
              "
            >
              <button style="border: none" (click)="enviarMensaje()">
                <i
                  id="iconBtn"
                  class="fa fa-send"
                  style="
                    font-size: 30px;
                    margin-top: 15px;
                    background: #00a6ff;
                    color: rgb(255, 255, 255);
                    padding: 15px;
                    border-radius: 30px;
                  "
                ></i>
              </button>
            </div>
          </div>
        </div>
       </div> 
      <!-- </div> -->
    </div> 
  </div> 
</section>
